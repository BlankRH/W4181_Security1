
environment: the test archive should be created/operated inside hw1_store


run:

make: this will create the executable cstore in the hw1_store directory; all commands should be run in this directory
make test: this will run the test script; it could be done by hand via ./script.sh
make clean: this will clean the test files generated by my test script


example:

.\cstore init [-p password] archive1 archive2 ...
.\cstore list archive
.\cstore add [-p password] archive file1 file2 ...
.\cstore extract [-p password] archive file1 file2 ...
.\cstore delete [-p password] archive file1 file2 ...


command descriptions:

.\cstore init [-p password] archive1 archive2 ...
init should create one/multiple archives with same password. There should be 2 plaintext files in it: metadata.txt(contain filenames) and hashcode.txt(contain hashcode).
If the archive to be created already exists, the program will print an error to STDERR and exit

.\cstore list archive
list should list all filenames currently inside the single target archive. 
If there was an unauthenticated operation on file/filenames since last legal operation, the list command would list the newest filenames without integrity check.

.\cstore add [-p password] archive file1 file2 ...
add should add listed files into the archive
if the files exists in the current working directory, add will copy its content to the file (with same name) into the target archive and then encrypt
if the files does not exist in the current working directory, add will create an empty file in the target archive
if the files already exists in the archive, add will print an error to STDERR and exit

.\cstore extract [-p password] archive file1 file2 ...
extract should extract listed files in the archive into the current working directory
if file does not exist in the target directory, extract will print an error to STDERR and exit

.\cstore delete [-p password] archive file1 file2 ...
delete should delete listed files in the archive
if file does not exist in the target directory, delete will print an error to STDERR and exit

additional function description:
if the target name is not of the correct type, the program will print an error to STDERR and exit


algorithm description:
I implemented AES-CBC in my_aes for encryption. The encryption key is gained from hashing the password 1e5 times. I also used pkcs7 padding.
HMAC is used for authentication. The HMAC key is gained from hashing the password 2e5 times. The result is stored in hashcode.txt. 
Each time an authentication is needed, I generate a new hashcode based on the input password and content of the archive, and then compare it with hashcode.txt
HMAC(hash_key, file1name1 || file1content1 || HMAC(hash_key, file1content1) || filename2....)


test:

the test script could be run by ./script.sh
it contains running basic operation and other operations that may cause authentication failure
*because the program will raise an error and exit if it could not finish the command, there would be a recipe error for make test